/*! asplode - v0.1.0 - 2014-06-04
* https://github.com/filamentgroup/asplode
* Copyright (c) 2014 Filament Group; Licensed MIT */
!function(a,b){"use strict";var c="asplode",d=function(b,c){if(!b)throw new Error("Element required to initialize object");this.element=b,this.$element=a(b),this.$img=this.$element.find("img"),this.$scroller=this.$element.find(".asplode-zoom"),this.scale=1,this.minScale=1,this.maxScale=1.8,this.scaleFactor=c&&c.scaleFactor||.8};d.prototype.setScale=function(a){this.$img.css({width:100*a+"%"})},d.prototype.pinch=function(a){this.scale=a,this.scale<this.minScale&&(this.scale=this.minScale),this.scale>this.maxScale&&(this.scale=this.maxScale),this.setScale(this.scale)},d.prototype.setMaxHeight=function(){this.$scroller.css("padding-top",this.$scroller[0].offsetHeight/this.$scroller[0].offsetWidth*100+"%"),this.$element.addClass("asplode-basic"),this.$img[0].offsetLeft},d.prototype.out=function(){this.scale-=this.scaleFactor,this.scale<this.minScale&&(this.scale=this.minScale),this.setScale(this.scale)},d.prototype.in=function(){this.setMaxHeight(),this.scale+=this.scaleFactor,this.scale>this.maxScale&&(this.scale=this.maxScale),this.setScale(this.scale)},d.prototype.buttons=function(){var b=this,d=a("<nav><button class='"+c+"-in' title='Zoom in'>+</button><button class='"+c+"-out' title='Zoom Out'>-</button></nav>");d.bind("touchend mouseup",function(d){a(d.target).is("."+c+"-in")?b.in():b.out(),d.originalEvent.preventDefault()}),d.appendTo(this.element)},d.prototype.toggleZoom=function(){this.scale===this.maxScale?this.out():this.in()},d.prototype.scrollToMouse=function(a){var b=this;b.scale!==b.minScale&&(b.$scroller[0].scrollLeft=(a.originalEvent.pageX-b.$element[0].offsetLeft)*b.scale,b.$scroller[0].scrollTop=(a.originalEvent.pageY-b.$element[0].offsetTop)*b.scale)},d.prototype.gestures=function(){var b,c=!1,d=this;this.$element.bind("touchstart",function(){c=!0}).bind("touchend",function(e){if(c=!1,!(a(e.target).closest("nav").length>0)){var f=(new Date).getTime();b&&500>f-b&&d.toggleZoom(),b=f,e.originalEvent.preventDefault()}}).bind("dblclick",function(){d.toggleZoom()}).bind("mouseover",function(){c||(d.$element.addClass("asplode-hovering"),d.in())}).bind("mouseout",function(){c||(d.$element.removeClass("asplode-hovering"),d.out())}).bind("mouseover mousemove",function(a){c||d.scrollToMouse(a)})},d.prototype.init=function(){this.buttons(),this.gestures()},(b.componentNamespace=b.componentNamespace||b)[c]=d}(jQuery,this);